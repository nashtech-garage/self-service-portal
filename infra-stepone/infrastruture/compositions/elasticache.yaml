apiVersion: ec2.aws.crossplane.io/v1beta1
kind: SecurityGroup
metadata:
  name: elasticache-sg
spec:
  forProvider:
    description: "Security group for ElastiCache"
    groupName: elasticache-sg
    vpcIdRef: 
      name: my-eks-vpc
  providerConfigRef:
    name: aws-provider
---
apiVersion: cache.aws.crossplane.io/v1beta1
kind: CacheSubnetGroup
metadata:
  name: elasticache-subnet-group
spec:
  forProvider:
    description: "Subnet group for ElastiCache"
    subnetIdRefs: 
      - name: private-subnet-a
      - name: private-subnet-b
  providerConfigRef:
    name: aws-provider
---
apiVersion: cache.aws.crossplane.io/v1beta1
kind: ReplicationGroup
metadata:
  name: my-elasticache-cluster
spec:
  forProvider:
    replicationGroupDescription: "My ElastiCache Cluster"
    engine: "redis"
    cacheNodeType: "cache.t3.micro"
    numCacheClusters: 1
    cacheSubnetGroupName: elasticache-subnet-group
    securityGroupIds:
      - elasticache-sg
  providerConfigRef:
    name: aws-provider